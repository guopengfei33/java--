package com.gpf.esTest;

import org.elasticsearch.action.search.SearchResponse;
import org.elasticsearch.client.Client;
import org.elasticsearch.client.transport.TransportClient;
import org.elasticsearch.common.settings.Settings;
import org.elasticsearch.common.transport.InetSocketTransportAddress;
import org.elasticsearch.index.query.QueryBuilder;

public class ElasticsearchUtils {

	private Client client;

	public ElasticsearchUtils(String clusterName, String ipAddress) {
		Settings settings = ImmutableSettings
				.settingsBuilder()
				// 设置集群名称
				.put("cluster.name", clusterName)
				.put("client.transport.ignore_cluster_name", false)
				.put("node.client", true).put("client.transport.sniff", true)
				.build();
		client = new TransportClient(settings)
				.addTransportAddress(new InetSocketTransportAddress(ipAddress,
						9200));// 此处端口号为9300
	}

	/** 
     * 创建索引 
     * @param indexName 索引名称，相当于数据库名称 
     * @param typeName 索引类型，相当于数据库中的表名 
     * @param id id名称，相当于每个表中某一行记录的标识 
     * @param jsonData json数据 
     */  
    public void createIndex(String indexName, String typeName, String id,  
            String jsonData) {  
        IndexRequestBuilder requestBuilder = client.prepareIndex(indexName,  
            typeName, id).setRefresh(true);//设置索引名称，索引类型，id  
        requestBuilder.setSource(jsonData).execute().actionGet();//创建索引  
    }  
}
